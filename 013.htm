<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <title>3. –ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è ‚Äî –°–∏—Å—Ç–µ–º–∞ –∞—Ä–µ–Ω–¥—ã —Å–ø–æ—Ä—Ç–∏–≤–Ω–æ–≥–æ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- –æ–±—â–∏–π —Å—Ç–∏–ª—å -->
  <link rel="stylesheet" href="styles.css" />

  <!-- –ª–æ–∫–∞–ª—å–Ω—ã–µ —à—Ç—Ä–∏—Ö–∏ + –≥—Ä–∞–Ω–∏—Ü—ã —Ç–∞–±–ª–∏—Ü -->
  <style>
    table { width: 100%; border-collapse: collapse; margin: 12px 0; }
    th, td { border: 1px solid #cfcfcf; padding: 6px 8px; vertical-align: top; }
    th { background: #f7f7f9; text-align: left; }
    code { background: #f6f8fa; padding: 1px 4px; border-radius: 3px; }
    nav a { margin-right: 10px; }
    .subtitle { color:#666; }
  </style>

  <!-- Mermaid -->
  <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
  <script>mermaid.initialize({ startOnLoad: true, securityLevel: 'loose' });</script>
</head>
<body>
  <div class="wrap">
    <header>
            <nav class="global-nav">
      <a href="index.htm">üìö –ì–ª–∞–≤–Ω–∞—è</a>
      <a href="012.htm">2. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ</a>
      <a href="013.htm">3. –ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</a>
      <a href="0114.htm">4. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è</a>
      <a href="0115.htm">5. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</a>
      <a href="0116.htm">6. –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</a>
    </nav>
      <h1>3. –ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è</h1>
      <div class="subtitle">–£—á–µ–±–Ω—ã–π –∫–µ–π—Å: ¬´–°–∏—Å—Ç–µ–º–∞ –∞—Ä–µ–Ω–¥—ã —Å–ø–æ—Ä—Ç–∏–≤–Ω–æ–≥–æ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è¬ª (.NET 6/8, C#)</div>
      <nav>
        <a href="#structure">3.1 –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã</a>
        <a href="#flow">3.2 –û—Å–Ω–æ–≤–Ω–æ–π –∞–ª–≥–æ—Ä–∏—Ç–º</a>
        <a href="#uml">3.3 UML –∫–ª–∞—Å—Å–æ–≤</a>
        <a href="#sequence">3.4 –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –º–æ–¥—É–ª–µ–π</a>
        <a href="#arch">3.5 –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã</a>
      </nav>
    </header>

    <!-- 3.1 -->
    <section id="structure">
      <h2>3.1. –û–ø–∏—Å–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã</h2>
      <p>–ü—Ä–æ–≥—Ä–∞–º–º–Ω—ã–π –ø—Ä–æ–¥—É–∫—Ç —Ä–µ–∞–ª–∏–∑—É–µ—Ç—Å—è –∫–∞–∫ –º–æ–¥—É–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ —è–∑—ã–∫–µ C# (.NET 6/8), —Å–æ—á–µ—Ç–∞—é—â–µ–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–π –∏ –æ–±—ä–µ–∫—Ç–Ω–æ-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥—ã. –û—Å–Ω–æ–≤–Ω—ã–µ —É—Ä–æ–≤–Ω–∏:</p>

      <table>
        <thead>
          <tr>
            <th>–£—Ä–æ–≤–µ–Ω—å</th>
            <th>–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ</th>
            <th>–ü—Ä–∏–º–µ—Ä—ã –∫–ª–∞—Å—Å–æ–≤/–º–æ–¥—É–ª–µ–π</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>–î–∞–Ω–Ω—ã–µ (Data Layer)</td>
            <td>–•—Ä–∞–Ω–µ–Ω–∏–µ –∏ –¥–æ—Å—Ç—É–ø –∫ –ª–æ–∫–∞–ª—å–Ω—ã–º JSON-—Ñ–∞–π–ª–∞–º</td>
            <td><code>DataStorage</code>, <code>FileRepository</code></td>
          </tr>
          <tr>
            <td>–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ (Business Logic)</td>
            <td>–û–ø–µ—Ä–∞—Ü–∏–∏ –∞—Ä–µ–Ω–¥—ã, —Ä–∞—Å—á—ë—Ç —Ç–∞—Ä–∏—Ñ–æ–≤, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞–º–∏</td>
            <td><code>RentalService</code>, <code>TariffCalculator</code>, <code>MaintenanceService</code></td>
          </tr>
          <tr>
            <td>–ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ (UI Layer)</td>
            <td>–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º (–º–µ–Ω—é –∏–ª–∏ —Ñ–æ—Ä–º—ã)</td>
            <td><code>Program</code>, <code>ConsoleUI</code>, <code>FormMain</code></td>
          </tr>
          <tr>
            <td>–ú–æ–¥–µ–ª–∏ (Domain Entities)</td>
            <td>–ö–ª–∞—Å—Å—ã –ø—Ä–µ–¥–º–µ—Ç–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏ (–æ–±—ä–µ–∫—Ç—ã —É—á—ë—Ç–∞)</td>
            <td><code>Customer</code>, <code>InventoryItem</code>, <code>Rental</code>, <code>Tariff</code>, <code>MaintenanceRecord</code></td>
          </tr>
        </tbody>
      </table>
    </section>

    <!-- 3.2 -->
    <section id="flow">
      <h2>3.2. –û—Å–Ω–æ–≤–Ω–æ–π –∞–ª–≥–æ—Ä–∏—Ç–º (flowchart)</h2>
      <p>–ë–ª–æ–∫-—Å—Ö–µ–º–∞ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è: –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∞—Ä–µ–Ω–¥—ã –∏ –≤–æ–∑–≤—Ä–∞—Ç –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è.</p>
      <pre class="mermaid">
flowchart TD
  A[–ù–∞—á–∞–ª–æ]
  B[–ú–µ–Ω—é: –≤—ã–±—Ä–∞—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ]
  C{–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –∞—Ä–µ–Ω–¥—É?}
  D[–í—ã–±–æ—Ä –∫–ª–∏–µ–Ω—Ç–∞]
  E[–í—ã–±–æ—Ä –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è]
  F{–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –¥–æ—Å—Ç—É–ø–µ–Ω?}
  G[–í—ã–±–æ—Ä —Ç–∞—Ä–∏—Ñ–∞]
  H[–†–∞—Å—á—ë—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏]
  I[–°–æ–∑–¥–∞–Ω–∏–µ –¥–æ–≥–æ–≤–æ—Ä–∞ –∞—Ä–µ–Ω–¥—ã status = open]
  J[–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ —Ñ–∞–π–ª rentals.json]
  K[–í—ã–≤–æ–¥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è]
  L{–í–æ–∑–≤—Ä–∞—Ç –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è?}
  M[–ü–æ–∏—Å–∫ –¥–æ–≥–æ–≤–æ—Ä–∞ –ø–æ ID]
  N[–í–≤–æ–¥ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏]
  O[–ü–µ—Ä–µ—Ä–∞—Å—á—ë—Ç —Å—É–º–º—ã –∏ —à—Ç—Ä–∞—Ñ–æ–≤]
  P[–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –Ω–∞ closed]
  Q[–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è –Ω–∞ –¥–æ—Å—Ç—É–ø–µ–Ω]
  R[–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç—á—ë—Ç–∞]
  Z[–ö–æ–Ω–µ—Ü]

  A --> B
  B --> C
  C -->|–î–∞| D
  D --> E
  E --> F
  F -->|–î–∞| G
  F -->|–ù–µ—Ç| B
  G --> H --> I --> J --> K --> B
  C -->|–ù–µ—Ç| L
  L -->|–î–∞| M --> N --> O --> P --> Q --> R --> B
  L -->|–ù–µ—Ç| Z
      </pre>
    </section>

    <!-- 3.3 -->
    <section id="uml">
      <h2>3.3. UML-–¥–∏–∞–≥—Ä–∞–º–º–∞ –∫–ª–∞—Å—Å–æ–≤</h2>
      <pre class="mermaid">
classDiagram
direction LR

class Customer {
  +Guid Id
  +string FullName
  +string Phone
  +string DocumentId
}

class InventoryItem {
  +Guid Id
  +string InvNumber
  +string Category
  +string Condition
  +string Status
  +DateTime LastServiceAt
  +void ChangeStatus(string newStatus)
}

class Tariff {
  +Guid Id
  +string Name
  +string Mode  // hour/day/package
  +decimal Rate
  +string RoundRule
}

class Rental {
  +Guid Id
  +Customer Customer
  +InventoryItem Item
  +Tariff Tariff
  +DateTime StartAt
  +DateTime? EndAt
  +decimal BaseAmount
  +decimal Discount
  +decimal Penalty
  +decimal Total
  +string Status
  +void CloseRental(DateTime endAt)
}

class MaintenanceRecord {
  +Guid Id
  +InventoryItem Item
  +DateTime Date
  +string Work
  +string Note
}

class TariffCalculator {
  +decimal Calculate(Tariff t, DateTime start, DateTime end)
}

class DataStorage {
  +List~Customer~ Customers
  +List~InventoryItem~ Items
  +List~Tariff~ Tariffs
  +List~Rental~ Rentals
  +List~MaintenanceRecord~ Maintenances
  +void LoadAll()
  +void SaveAll()
}

class RentalService {
  +void OpenRental(Customer c, InventoryItem i, Tariff t)
  +void CloseRental(Guid rentalId)
  +List~Rental~ GetActiveRentals()
}

Customer "1" --> "0..*" Rental : –æ—Ñ–æ—Ä–º–ª—è–µ—Ç
InventoryItem "1" --> "0..*" Rental : —É—á–∞—Å—Ç–≤—É–µ—Ç
InventoryItem "1" --> "0..*" MaintenanceRecord : –ø—Ä–æ—Ö–æ–¥–∏—Ç –¢–û
Tariff "1" --> "0..*" Rental : –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è
RentalService --> DataStorage : –∏—Å–ø–æ–ª—å–∑—É–µ—Ç
Rental --> TariffCalculator : —Ä–∞—Å—á—ë—Ç
      </pre>

      <p><strong>–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤:</strong></p>
      <ul>
        <li><code>Customer</code> ‚Äî –º–æ–¥–µ–ª—å –∫–ª–∏–µ–Ω—Ç–∞.</li>
        <li><code>InventoryItem</code> ‚Äî –æ–ø–∏—Å–∞–Ω–∏–µ –µ–¥–∏–Ω–∏—Ü—ã –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è –∏ —Å—Ç–∞—Ç—É—Å–æ–≤.</li>
        <li><code>Tariff</code> ‚Äî —Ç–∞—Ä–∏—Ñ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ —Ä–∞—Å—á—ë—Ç–∞.</li>
        <li><code>Rental</code> ‚Äî –¥–æ–≥–æ–≤–æ—Ä –∞—Ä–µ–Ω–¥—ã, —Å–≤—è–∑—å –∫–ª–∏–µ–Ω—Ç‚Üî–∏–Ω–≤–µ–Ω—Ç–∞—Ä—å‚Üî—Ç–∞—Ä–∏—Ñ.</li>
        <li><code>MaintenanceRecord</code> ‚Äî –∑–∞–ø–∏—Å—å —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è.</li>
        <li><code>TariffCalculator</code> ‚Äî –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –ø–æ —Ç–∞—Ä–∏—Ñ—É –∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª—É –≤—Ä–µ–º–µ–Ω–∏.</li>
        <li><code>DataStorage</code> ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞/—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ JSON.</li>
        <li><code>RentalService</code> ‚Äî –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞—Ä–µ–Ω–¥–∞–º–∏.</li>
      </ul>
    </section>

    <!-- 3.4 -->
    <section id="sequence">
      <h2>3.4. –°—Ö–µ–º–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –º–æ–¥—É–ª–µ–π</h2>
      <pre class="mermaid">
sequenceDiagram
  participant U as –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
  participant UI as –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å
  participant RS as RentalService
  participant DS as DataStorage
  participant TC as TariffCalculator

  U->>UI: –í—ã–±—Ä–∞—Ç—å "–°–æ–∑–¥–∞—Ç—å –∞—Ä–µ–Ω–¥—É"
  UI->>RS: –ó–∞–ø—Ä–æ—Å —Å–æ–∑–¥–∞–Ω–∏—è –∞—Ä–µ–Ω–¥—ã (–¥–∞–Ω–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç–∞, –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è, —Ç–∞—Ä–∏—Ñ–∞)
  RS->>DS: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
  DS-->>RS: –°—Ç–∞—Ç—É—Å "–¥–æ—Å—Ç—É–ø–µ–Ω"
  RS->>TC: –†–∞—Å—Å—á–∏—Ç–∞—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å (startAt, tariff)
  TC-->>RS: –í–æ–∑–≤—Ä–∞—Ç —Å—É–º–º—ã
  RS->>DS: –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–æ–≥–æ–≤–æ—Ä –≤ rentals.json
  DS-->>RS: –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
  RS-->>UI: –£—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω –¥–æ–≥–æ–≤–æ—Ä
  UI-->>U: –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏ —Å—É–º–º–∞ –∞—Ä–µ–Ω–¥—ã
      </pre>
    </section>

    <!-- 3.5 -->
    <section id="arch">
      <h2>3.5. –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –∏ –ø—Ä–æ–µ–∫—Ç–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π</h2>
      <ul>
        <li>–®–∞–±–ª–æ–Ω <em>Layered Architecture</em> (UI / Business Logic / Data / Domain).</li>
        <li>–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–µ–π JSON (—á–µ—Ä–µ–∑ <code>System.Text.Json</code>); –∞—Ç–æ–º–∞—Ä–Ω–∞—è –∑–∞–ø–∏—Å—å —Ñ–∞–π–ª–æ–≤.</li>
        <li>–ò–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—è –¥–æ–º–µ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π; –æ–ø–µ—Ä–∞—Ü–∏–∏ ‚Äî —á–µ—Ä–µ–∑ —Å–µ—Ä–≤–∏—Å—ã (<code>RentalService</code>, <code>MaintenanceService</code>).</li>
        <li>–í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π –Ω–∞ –≥—Ä–∞–Ω–∏—Ü–∞—Ö —Å–ª–æ—ë–≤.</li>
        <li>–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ XML-–∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏ –¥–ª—è –∫–ª—é—á–µ–≤—ã—Ö —Ç–∏–ø–æ–≤ –∏ –º–µ—Ç–æ–¥–æ–≤.</li>
      </ul>
    </section>

    
  </div>
</body>
</html>

